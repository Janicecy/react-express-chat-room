(this["webpackJsonpreact-express-chat-room"]=this["webpackJsonpreact-express-chat-room"]||[]).push([[0],{138:function(e,t,a){},368:function(e,t,a){"use strict";a.r(t);var n=a(3),r=a(0),o=a.n(r),c=a(55),s=a.n(c),i=(a(138),a(387)),l=a(129),u=a(28),d=a(36),b=a(24),m=a(29),p="SET_ROOM",f="USER_JOIN",h="USER_LEAVE",j="NEW_MESSAGE",g="TEXT",x="IMAGE",v="USER_JOIN",O="USER_LEAVE",y={messages:[],currentUsers:[]},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0,a=e.currentUsers,n=e.messages;switch(t.type){case p:return t.room;case f:return Object(m.a)(Object(m.a)({},e),{},{messages:[].concat(Object(b.a)(n),[{type:v,author:t.author}]),currentUsers:[].concat(Object(b.a)(a),[t.author])});case h:return Object(m.a)(Object(m.a)({},e),{},{messages:[].concat(Object(b.a)(n),[{type:O,author:t.author}]),currentUsers:a.filter((function(e){return e!==t.author}))});case j:return Object(m.a)(Object(m.a)({},e),{},{messages:[].concat(Object(b.a)(n),[t.message])});default:return e}},k="SET_USER",S=function(e){return{type:k,payload:e}},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k:return t.payload;default:return e}},C=a(77),E=a(119),U=a.n(E),z=(a(146),Object(d.a)({room:w,user:Object(C.a)({key:"user",storage:U.a},N)})),M=Object(d.b)(z),R=Object(C.b)(M),I=M,V=a(120),_=a(74),A=a(14),D=a(17),T=a(12),J=a(388),W=a(121),q=a.n(W)()("https://react-express-chat-room.herokuapp.com");q.on("chat_room",(function(e){switch(e.eventType){case f:return I.dispatch((a=e.payload,{type:f,author:a}));case j:return I.dispatch((t=e.payload,{type:j,message:t}));case h:return I.dispatch(function(e){return{type:h,author:e}}(e.payload))}var t,a}));var L=q,B=a(20),H=a.n(B),P=a(41),F=a(124),G=a.n(F);function K(e){return new Promise((function(t,a){try{if(void 0!==e){if(!["image/jpeg","image/png"].includes(e.type))return a("Unsported image type!");if(e.size>2097152)return a("Maximum image size is 2MB!");var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return t(n.result)},n.onerror=function(e){return a(e)}}}catch(r){a(r.message)}}))}var X=Object(J.a)((function(e){return{root:{height:"10%",display:"flex",alignItems:"center",backgroundColor:"var(--panel-bg)",justifyContent:"space-between",padding:"0 5%",width:"100%"},uploadIcon:{color:"grey",fontSize:"2rem"}}})),Y=function(e){var t=X(),a=Object(r.useState)(""),o=Object(D.a)(a,2),c=o[0],s=o[1],i=function(){var t=Object(P.a)(H.a.mark((function t(a){var n;return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,K(a.target.files[0]);case 3:n=t.sent,e.onNewMessage({type:x,content:n}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),l=function(){""!==c&&(e.onNewMessage({type:g,content:c}),s(""))};return Object(n.jsxs)("div",{className:t.root,children:[Object(n.jsxs)("div",{children:[Object(n.jsx)("label",{htmlFor:"upload",children:Object(n.jsx)(G.a,{className:t.uploadIcon})}),Object(n.jsx)("input",{type:"file",id:"upload",onChange:i,accept:"image/png, image/jpeg"})]}),Object(n.jsx)("input",{type:"textarea",className:t.input,wrap:"soft",placeholder:"Type a message",onChange:function(e){return s(e.target.value)},value:c,style:{flex:"0 1 50%"},onKeyUp:function(e){"Enter"===e.key&&l()}}),Object(n.jsx)("button",{value:"Send",onClick:l,style:{flex:"0 1 20%"},children:"Send"})]})},Q=a(58),Z=a.n(Q),$=Object(J.a)((function(e){return{userEventMessage:{fontSize:"0.8em",textAlign:"center",opacity:.8,margin:"5px auto"},username:{color:"#60a3bc",fontWeight:"bold"},message:{backgroundColor:"#262d31",borderRadius:8,marginTop:10,width:"auto",display:"flex",flexDirection:"column",padding:"5px 10px",alignSelf:"flex-start",maxWidth:"50%",wordBreak:"break-word"},author:{color:"#acacac",fontSize:12,margin:"4px 0"},time:{color:" #8b8c8b",alignSelf:"flex-end",marginTop:5,fontSize:"0.5em"},sender:{backgroundColor:"#056162",alignSelf:"flex-end"},imgMessage:{width:"100%"}}}));var ee=function(e){var t=e.message,a=e.isSender,r=$(),o=t.content,c=t.author,s=t.createdAt;return Object(n.jsxs)("div",{className:Z()(r.message,a&&r.sender),children:[Object(n.jsxs)("div",{className:r.author,children:["~",c]}),function(){switch(t.type){case g:return Object(n.jsx)("div",{className:r.text,children:o});case x:return Object(n.jsx)("img",{alt:"message",className:r.imgMessage,src:o});default:return null}}(),Object(n.jsx)("div",{className:r.time,children:new Date(s).toLocaleDateString()})]})},te=Object(J.a)((function(e){return{root:{backgroundColor:"black",overflow:"auto",height:"90%",color:"#fff",padding:20,display:"flex",flexDirection:"column"},userEventMessage:{fontSize:"0.8em",textAlign:"center",opacity:.8,margin:"5px auto"},author:{color:"#60a3bc",fontWeight:"bold"}}})),ae=function(e){var t=te(),a=e.messages,r=e.currentUser,o=function(e){var a=e.author,r=e.type;return Object(n.jsxs)("div",{className:t.userEventMessage,children:[Object(n.jsx)("span",{className:t.author,children:a}),"USER_JOIN"===r?" just joined the room \ud83d\udc4b":" just left the room"]})};return Object(n.jsx)("div",{className:t.root,children:a.map((function(e){var t=e.author,a=e.type,c=e.id;return["USER_LEAVE","USER_JOIN"].includes(a)?Object(n.jsx)(o,{author:t,type:a},c):Object(n.jsx)(ee,{isSender:t===r,message:e},c)}))})},ne=a(125),re=a.n(ne),oe=Object(J.a)((function(e){return{root:Object(T.a)({background:"#16161a",flex:"0 0 25%",marginRight:5,position:"relative"},e.breakpoints.down("sm"),{flex:"0 0 100%",margin:0,height:"94vh"}),title:{textAlign:"center",color:"#fff"},owner:{color:"#048f81",border:"1px solid#048f81",borderRadius:3,height:"auto",padding:"2px 7px",fontSize:12},user:{display:"flex",justifyContent:"space-around",padding:"5px 10px",borderBottom:" 1px solid #293136",color:"#fff",alignItems:"center"},avatar:{flex:"0 0 20%",fontSize:25},username:{flex:"0 0 20%"},logout:{color:"#60a3bc",cursor:"pointer",position:"absolute",bottom:30,right:30}}}));function ce(e){var t=e.room,a=oe(),r=Object(u.b)();return Object(n.jsxs)("div",{className:a.root,children:[Object(n.jsxs)("h2",{className:a.title,children:["Chat Room - ",Object(n.jsx)("span",{style:{color:"lightblue"},children:t.id})]}),t.currentUsers.map((function(e){return Object(n.jsxs)("div",{className:a.user,children:[Object(n.jsx)(re.a,{fontSize:"large",className:a.avatar}),Object(n.jsx)("span",{className:a.username,children:e}),Object(n.jsx)("span",{style:{opacity:e!==t.owner&&0},className:a.owner,children:"Owner"})]},e)})),Object(n.jsx)("div",{onClick:function(){L.emit("leave_room"),r(S({}))},className:a.logout,children:"Logout"})]})}var se=a(42),ie=a.n(se),le=a(126),ue=a.n(le),de=a(130),be=Object(J.a)((function(e){return{root:Object(T.a)({display:"flex",width:"var(--width)",margin:"0 auto",boxShadow:"0 1px 2px -2px rgba(0,0,0,.16), 0 3px 6px 0 rgba(0,0,0,.12), 0 5px 12px 4px rgba(0,0,0,.09)",height:"var(--height)",backgroundColor:"var(--chat-room-bg)",marginTop:"2%"},e.breakpoints.down("sm"),{width:"100vw",position:"fixed",top:"6vh",height:"94vh",margin:0}),chat:Object(T.a)({flex:"0 0 75%"},e.breakpoints.down("sm"),{flex:"0 0 100%",margin:0}),mobileHeader:Object(T.a)({position:"fixed",top:0,width:"100%",padding:"10px 20px",display:"flex",justifyContent:"flex-end",backgroundColor:"#2a2f32",alignItems:"center",height:"6vh",color:"#fff"},e.breakpoints.up("sm"),{display:"none"})}})),me=function(e){var t=Object(u.b)(),a=Object(u.c)((function(e){return e.room})),o=Object(u.c)((function(e){return e.user})).username,c=a.messages,s=Object(A.g)().roomId,i=Object(r.useState)(window.innerWidth>600),l=Object(D.a)(i,2),d=l[0],b=l[1],f=be((function(){return b(!d)})),h=function(){ie.a.get("/api/rooms/".concat(s)).then((function(e){var a=e.data.room;t(function(e){return{type:p,room:e}}(a)),L.emit("join_room",o,a.id)})).catch((function(t){return e.history.push("/")}))};Object(r.useEffect)((function(){h()}),[]),Object(r.useEffect)((function(){if(!o||!s)return e.history.push("/")}),[o,s]);return Object(n.jsxs)("div",{className:f.root,children:[Object(n.jsx)("div",{className:f.mobileHeader,children:Object(n.jsx)(ue.a,{onClick:function(){return b(!d)}})}),d&&Object(n.jsx)(ce,{room:a,currentUser:o}),Object(n.jsxs)("div",{className:f.chat,children:[Object(n.jsx)(ae,{messages:c,currentUser:o}),Object(n.jsx)(Y,{onNewMessage:function(e){L.emit("new_message",Object(m.a)(Object(m.a)({},e),{},{createdAt:Date.now(),author:o,id:Object(de.a)()}),a.id)}})]})]})},pe=a(127),fe=a.n(pe);function he(){return Object(n.jsx)(fe.a,{id:"tsparticles",options:{autoPlay:!0,background:{color:{value:"#232741"},image:"",position:"",repeat:"",size:"",opacity:1},height:"100%",backgroundMask:{composite:"destination-out",cover:{color:{value:"#fff"},opacity:1},enable:!1},backgroundMode:{enable:!0,zIndex:-1},detectRetina:!0,fpsLimit:30,infection:{cure:!1,delay:0,enable:!1,infections:0,stages:[]},interactivity:{detectsOn:"canvas",events:{onClick:{enable:!0,mode:"repulse"},onDiv:{selectors:[],enable:!1,mode:[],type:"circle"},onHover:{enable:!0,mode:"bubble",parallax:{enable:!1,force:2,smooth:10}},resize:!0},modes:{attract:{distance:200,duration:.4,speed:1},bounce:{distance:200},bubble:{distance:250,duration:2,opacity:0,size:0},connect:{distance:80,links:{opacity:.5},radius:60},grab:{distance:400,links:{blink:!1,consent:!1,opacity:1}},light:{area:{gradient:{start:{value:"#ffffff"},stop:{value:"#000000"}},radius:1e3},shadow:{color:{value:"#000000"},length:2e3}},push:{quantity:4},remove:{quantity:2},repulse:{distance:400,duration:.4,speed:1},slow:{factor:3,radius:200},trail:{delay:1,quantity:1}}},manualParticles:[],motion:{disable:!1,reduce:{factor:4,value:!1}},particles:{bounce:{horizontal:{random:{enable:!1,minimumValue:.1},value:1},vertical:{random:{enable:!1,minimumValue:.1},value:1}},collisions:{bounce:{horizontal:{random:{enable:!1,minimumValue:.1},value:1},vertical:{random:{enable:!1,minimumValue:.1},value:1}},enable:!1,mode:"bounce"},color:{value:"#ffffff",animation:{enable:!1,speed:1,sync:!0}},life:{count:0,delay:{random:{enable:!1,minimumValue:0},value:0,sync:!1},duration:{random:{enable:!1,minimumValue:1e-4},value:0,sync:!1}},links:{blink:!1,color:{value:"#ffffff"},consent:!1,distance:150,enable:!1,frequency:1,opacity:.4,shadow:{blur:5,color:{value:"#00ff00"},enable:!1},triangles:{enable:!1,frequency:1},width:1,warp:!1},move:{angle:{offset:45,value:90},attract:{enable:!1,rotate:{x:600,y:600}},direction:"none",distance:0,enable:!0,gravity:{acceleration:9.81,enable:!1,maxSpeed:50},noise:{delay:{random:{enable:!1,minimumValue:0},value:0},enable:!1},outModes:{default:"out",bottom:"out",left:"out",right:"out",top:"out"},random:!0,size:!1,speed:1,straight:!1,trail:{enable:!1,length:10,fillColor:{value:"#000000"}},vibrate:!1,warp:!1},number:{density:{enable:!0,area:800,factor:1e3},limit:0,value:160},opacity:{random:{enable:!0,minimumValue:.1},value:1,animation:{enable:!0,minimumValue:0,speed:1,sync:!1}},reduceDuplicates:!1,rotate:{random:{enable:!1,minimumValue:0},value:0,animation:{enable:!1,speed:0,sync:!1},direction:"clockwise",path:!1},shadow:{blur:0,color:{value:"#000000"},enable:!1,offset:{x:0,y:0}},shape:{options:{polygon:{nb_sides:5},star:{nb_sides:5},image:{src:"https://cdn.matteobruni.it/images/particles/github.svg",width:100,height:100},images:{src:"https://cdn.matteobruni.it/images/particles/github.svg",width:100,height:100}},type:"circle"},size:{random:{enable:!0,minimumValue:1},value:3,animation:{destroy:"none",enable:!1,minimumValue:.3,speed:4,startValue:"max",sync:!1}},stroke:{width:0,color:{value:"#000000",animation:{enable:!1,speed:1,sync:!0}}},twinkle:{lines:{enable:!1,frequency:.05,opacity:1},particles:{enable:!1,frequency:.05,opacity:1}}},pauseOnBlur:!0,pauseOnOutsideViewport:!1,themes:[]}})}var je=a(128),ge=a.n(je),xe=Object(J.a)((function(e){var t;return{root:Object(T.a)({display:"flex",height:"100vh",color:"#fff",fontWeight:"bold",width:"100vw"},e.breakpoints.down("sm"),{flexWrap:"wrap",justifyContent:"center"}),section:(t={display:"flex",flexDirection:"column",alignItems:"center",flex:"0 1 50%",justifyContent:"center",fontSize:30},Object(T.a)(t,e.breakpoints.down("sm"),{flex:"0 1 100%",height:"50vh",fontSize:20}),Object(T.a)(t,"& > *",{marginTop:20}),t),joinRoom:{backgroundColor:"black",boxShadow:"10px 0px 40px white"},errorMessage:{color:"#ff0033",fontWeight:"bold",margin:"10px auto",fontSize:"1rem"}}})),ve=function(e){var t=xe(),a=Object(r.useState)(""),o=Object(D.a)(a,2),c=o[0],s=o[1],i=Object(r.useState)(""),l=Object(D.a)(i,2),d=l[0],b=l[1],m=Object(r.useState)(""),p=Object(D.a)(m,2),f=p[0],h=p[1],j=Object(r.useState)(""),g=Object(D.a)(j,2),x=g[0],v=g[1],O=Object(u.b)(),y=function(){var t=Object(P.a)(H.a.mark((function t(){var a,n;return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==d&&""!==c){t.next=2;break}return t.abrupt("return",h("room id or username can not be empty"));case 2:return t.prev=2,t.next=5,ie.a.get("/api/rooms/".concat(c));case 5:a=t.sent,(n=a.data.room).currentUsers.includes(d)?h("Username has been taken."):(O(S({username:d})),e.history.push("/room/".concat(n.id))),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),h(t.t0.response.data.error);case 13:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(){return t.apply(this,arguments)}}(),w=function(){var t=Object(P.a)(H.a.mark((function t(){var a,n;return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(d){t.next=2;break}return t.abrupt("return",v("Username can not be empty"));case 2:return t.prev=2,t.next=5,ie.a.post("/api/rooms",{owner:d});case 5:a=t.sent,n=a.data.room,O(S({username:d})),e.history.push("/room/".concat(n.id)),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(2),v(t.t0.response.data.error);case 14:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(){return t.apply(this,arguments)}}();return Object(n.jsxs)("div",{className:t.root,children:[Object(n.jsx)(ge.a,{className:"githubIcon",onClick:function(){return window.open("https://github.com/JANICECY/react-express-chat-room")}}),Object(n.jsxs)("div",{className:t.section,children:[Object(n.jsxs)("label",{children:["Create a new room",Object(n.jsx)("span",{children:"\ud83e\udd13"})]}),Object(n.jsx)("input",{value:d,placeholder:"Username",onChange:function(e){return b(e.target.value)}}),Object(n.jsx)("button",{onClick:w,children:"Create"}),Object(n.jsx)("span",{className:t.errorMessage,children:x})]}),Object(n.jsxs)("div",{className:Z()(t.section,t.joinRoom),children:[Object(n.jsx)(he,{}),Object(n.jsxs)("label",{children:["Join a private room",Object(n.jsx)("span",{children:"\ud83e\uddd0"})]}),Object(n.jsx)("input",{value:c,placeholder:"Room ID",onChange:function(e){return s(e.target.value)}}),Object(n.jsx)("input",{value:d,placeholder:"Username",onChange:function(e){return b(e.target.value)}}),Object(n.jsx)("button",{onClick:y,children:"Join"}),Object(n.jsx)("span",{className:t.errorMessage,children:f})]})]})};function Oe(){return Object(n.jsx)(_.a,{children:Object(n.jsxs)(A.d,{children:[Object(n.jsx)(A.b,{exact:!0,path:"/",component:ve}),Object(n.jsx)(A.b,{exact:!0,path:"/room/:roomId",component:me}),Object(n.jsx)(A.b,{render:function(){return Object(n.jsx)(A.a,{to:"/"})}})]})})}var ye=Object(l.a)();s.a.render(Object(n.jsx)(o.a.StrictMode,{children:Object(n.jsx)(i.a,{theme:ye,children:Object(n.jsx)(u.a,{store:I,children:Object(n.jsx)(V.a,{persistor:R,loading:null,children:Object(n.jsx)(Oe,{})})})})}),document.getElementById("root"))}},[[368,1,2]]]);
//# sourceMappingURL=main.f9f142b8.chunk.js.map